{% extends "_layouts/cp" %}
{% set title = "Globals"|t %}

{% if file is not empty and file.status != 'complete' and file.status != 'published' and file.status != 'new' %}
    {% includeJsResource 'acclarotranslations/js/DisableFields.js' %}
{% endif %}

{% block pageTitle %}
    {{ parent() }}

    <div class="select">
        <select onchange="document.location.href='{{ url('globals/{locale}/'~globalSetHandle) }}'.replace('{locale}', this.value);">
            {% for locale in craft.i18n.getEditableLocales() %}
                <option value="{{ locale.id }}"{% if locale.id == draft.locale %} selected{% endif %}>{{ locale.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="select" style="margin-left:0.75em;">
        <select onchange="document.location.href=this.options[this.selectedIndex].value;">
            <option value="{{ url('globals/'~draft.locale~'/'~globalSetHandle) }}"{>{{ 'Current'|t }}</option>
            {% for d in drafts %}
            <option value="{{ d.cpEditUrl }}"{% if draftId == d.draftId %} selected{% endif %}>{{ d.name }}</option>
            {% endfor %}
        </select>
    </div>
{% endblock %}


{% block sidebar %}
    <nav>
        <ul>
            {% for globalSet in globalSets %}
                <li><a{% if globalSet.handle == globalSetHandle %} class="sel"{% endif %} href="{{ globalSet.getCpEditUrl() }}">{{ globalSet.name|t }}</a></li>
            {% endfor %}
        </ul>
    </nav>
{% endblock %}


{% block content %}
    <form method="post" accept-charset="UTF-8" data-saveshortcut data-confirm-unload>
        <input type="hidden" name="action" value="acclaroTranslations/saveGlobalSetDraft">
        <input type="hidden" name="draftId" value="{{ draft.draftId }}">
        <input type="hidden" name="locale" value="{{ draft.locale }}">
        <input type="hidden" name="globalSetId" value="{{ globalSetId }}">
        {{ getCsrfInput() }}

        {% if draft.getFieldLayout().getFields() | length %}
            <div>
                {% include "_includes/fields" with {
                    fields: draft.getFieldLayout().getFields(),
                    element: draft
                } only %}
            </div>

            <div class="buttons">
                <div class="btngroup">
                    <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
                    <div class="btn submit menubtn"></div>
                    <div class="menu">
                        <ul>
                            <li><a class="formsubmit" data-action="acclaroTranslations/publishGlobalSetDraft">{{ 'Publish draft'|t }}</a></li>
                        </ul>
                        <hr>
                        <ul>
                            <li><a class="formsubmit" data-action="acclaroTranslations/deleteGlobalSetDraft" data-confirm="{{ 'Are you sure you want to delete this draft?'|t }}">{{ 'Delete draft'|t }}</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        {% else %}
            {{ "This global set doesnâ€™t have any fields assigned to it in its field layout."|t }}
        {% endif %}
    </form>
{% endblock %}
