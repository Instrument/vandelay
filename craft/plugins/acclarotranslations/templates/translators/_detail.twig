{% extends '_layouts/cp' %}
{% import '_includes/forms' as forms %}

{% set tabs = adminTabs %}
{% set selectedTab = 'translators' %}

{% set title = 'Translations'|t %}
{% set extraPageHeaderHtml = '<small class="acclarotranslations-version-header">' ~ 'Version'|t ~ ' ' ~ pluginVersion ~ '</small>' %}

{% includeJsResource "acclarotranslations/js/TranslatorDetail.js" %}
{% includeCssResource "acclarotranslations/css/AcclaroTranslations.css" %}

{% set crumbs = [
    { label: 'Translations'|t, url: url('acclarotranslations') },
    { label: 'Translators'|t, url: url('acclarotranslations/translators') },
] %}

{% if translatorId %}
    {% set crumbs = crumbs|merge([
        { label: 'Edit Translation Service'|t, url: 'javascript:void(0)' },
    ])%}
{% else %}
    {% set crumbs = crumbs|merge([
        { label: 'Add New Translation Service'|t, url: 'javascript:void(0)' },
    ])%}
{% endif %}

{% block content %}
    <form method="post" class="acclarotranslations-translator-form" data-confirm-unload accept-charset="UTF-8">
        {{ getCsrfInput() }}

        {{ forms.hidden({
            name: 'id',
            value: translatorId,
        }) }}

        {{ forms.hidden({
            name: 'status',
            id: 'status',
            value: translator.status ?: 'inactive',
        }) }}

        {{ forms.hidden({
            name: 'action',
            value: 'acclaroTranslations/saveTranslator'
        }) }}

        {% if translatorId %}
        <h1>{{ 'Edit Translation Service'|t }}</h1>
        {% else %}
        <h1>{{ 'Add New Translation Service'|t }}</h1>
        {% endif %}

        {{ forms.selectField({
            label: 'Translation Service'|t,
            options: {'':'Choose'|t ~ '...'}|merge(translationServices),
            value: translator.service,
            name: 'service',
            id: 'service',
        }) }}

        {{ forms.textField({
            label: 'Translation Service Custom Label'|t,
            value: translator.label,
            name: 'label',
            id: 'label',
            size: 20,
            placeholder: 'Optional'|t,
        }) }}

        {{ forms.checkboxSelectField({
            label: 'Language(s)'|t,
            options: languages,
            value: translator.languagesArray,
            name: 'languages',
            id: 'languages'
        }) }}

        <p><a href="{{ url('settings/locales') }}" target="_blank">{{ 'Add more languages from the Craft Locales settings page.'|t }} &raquo;</a></p>

        <h2 class="acclarotranslations-translator-settings-header">{{ 'Translation Service Configuration'|t }}</h2>
        <div class="acclarotranslations-translator-settings" id="settings-acclaro">
            <div class="acclarotranslations-translator-logo-acclaro"></div>

            {{ forms.textField({
                label: 'Acclaro API Token'|t,
                value: translator.setting('apiToken'),
                name: 'settings[acclaro][apiToken]',
                size: 20,
                id: 'settings-acclaro-apiToken',
            }) }}

            <div class="field">
                <div class="input {{ orientation }}">
                    <button class="btn acclarotranslations-authenticate-translation-service">{{ 'Authenticate'|t }}</button>
                </div>
            </div>

            {{ forms.checkboxField({
                label: 'Sandbox Mode'|t,
                value: 1,
                checked: translator.setting('sandboxMode'),
                name: 'settings[acclaro][sandboxMode]',
                id: 'settings-acclaro-sandboxMode',
            }) }}
        </div>

        <div class="item" data-position="left" data-colspan="1">
            <div class="buttons">
                <div class="btngroup submit first">
                    <input type="submit" class="btn submit" value="{{ 'Save'|t }}">
                </div>
            </div>
        </div>
    </form>
{% endblock %}